{
  "meta": {
    "timestamp": "2023-12-20T11:03:37.274679",
    "version": "6.1.0",
    "argv": [
      "-j",
      "C:\\Users\\REM\\Desktop\\Practical Malware Analysis Labs\\BinaryCollection\\Chapter_14L\\Lab14-02.exe"
    ],
    "sample": {
      "md5": "14d4bdcc5f0fe917abde4b01e39a350e",
      "sha1": "a2a7352960517502487fb46253a057f51872625e",
      "sha256": "435be1c6e904836ad65f97f3eac4cbe19ee7ba0da48178fc7f00206270469165",
      "path": "C:/Users/REM/Desktop/Practical Malware Analysis Labs/BinaryCollection/Chapter_14L/Lab14-02.exe"
    },
    "analysis": {
      "format": "pe",
      "arch": "i386",
      "os": "windows",
      "extractor": "VivisectFeatureExtractor",
      "rules": [
        "C:/Users/REM/AppData/Local/Temp/_MEI46282/rules"
      ],
      "base_address": {
        "type": "absolute",
        "value": 4194304
      },
      "layout": {
        "functions": [
          {
            "address": {
              "type": "absolute",
              "value": 4198400
            },
            "matched_basic_blocks": [
              {
                "address": {
                  "type": "absolute",
                  "value": 4198449
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4198607
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4198671
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4198688
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4198787
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4198801
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4198816
                }
              }
            ]
          },
          {
            "address": {
              "type": "absolute",
              "value": 4198848
            },
            "matched_basic_blocks": [
              {
                "address": {
                  "type": "absolute",
                  "value": 4198848
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4199274
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4199326
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4199354
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4199392
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4199420
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4199467
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4199489
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4199508
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4199581
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4199590
                }
              }
            ]
          },
          {
            "address": {
              "type": "absolute",
              "value": 4199616
            },
            "matched_basic_blocks": [
              {
                "address": {
                  "type": "absolute",
                  "value": 4199616
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4199734
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4199793
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4199805
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4199836
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4200010
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4200033
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4200043
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4200098
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4200177
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4200205
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4200228
                }
              }
            ]
          },
          {
            "address": {
              "type": "absolute",
              "value": 4200272
            },
            "matched_basic_blocks": [
              {
                "address": {
                  "type": "absolute",
                  "value": 4200272
                }
              }
            ]
          },
          {
            "address": {
              "type": "absolute",
              "value": 4200448
            },
            "matched_basic_blocks": [
              {
                "address": {
                  "type": "absolute",
                  "value": 4200505
                }
              }
            ]
          },
          {
            "address": {
              "type": "absolute",
              "value": 4200576
            },
            "matched_basic_blocks": [
              {
                "address": {
                  "type": "absolute",
                  "value": 4200674
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4200843
                }
              },
              {
                "address": {
                  "type": "absolute",
                  "value": 4200912
                }
              }
            ]
          }
        ]
      },
      "feature_counts": {
        "file": 323,
        "functions": [
          {
            "address": {
              "type": "absolute",
              "value": 4198400
            },
            "count": 103
          },
          {
            "address": {
              "type": "absolute",
              "value": 4198848
            },
            "count": 198
          },
          {
            "address": {
              "type": "absolute",
              "value": 4199616
            },
            "count": 124
          },
          {
            "address": {
              "type": "absolute",
              "value": 4200272
            },
            "count": 65
          },
          {
            "address": {
              "type": "absolute",
              "value": 4200448
            },
            "count": 50
          },
          {
            "address": {
              "type": "absolute",
              "value": 4200576
            },
            "count": 111
          },
          {
            "address": {
              "type": "absolute",
              "value": 4200928
            },
            "count": 7
          },
          {
            "address": {
              "type": "absolute",
              "value": 4200934
            },
            "count": 7
          },
          {
            "address": {
              "type": "absolute",
              "value": 4200940
            },
            "count": 7
          },
          {
            "address": {
              "type": "absolute",
              "value": 4200946
            },
            "count": 7
          },
          {
            "address": {
              "type": "absolute",
              "value": 4200952
            },
            "count": 7
          },
          {
            "address": {
              "type": "absolute",
              "value": 4201308
            },
            "count": 7
          },
          {
            "address": {
              "type": "absolute",
              "value": 4201314
            },
            "count": 7
          },
          {
            "address": {
              "type": "absolute",
              "value": 4201338
            },
            "count": 6
          },
          {
            "address": {
              "type": "absolute",
              "value": 4201341
            },
            "count": 6
          },
          {
            "address": {
              "type": "absolute",
              "value": 4201350
            },
            "count": 7
          }
        ]
      },
      "library_functions": [
        {
          "address": {
            "type": "absolute",
            "value": 4200958
          },
          "name": "_WinMainCRTStartup"
        },
        {
          "address": {
            "type": "absolute",
            "value": 4201320
          },
          "name": "__setdefaultprecision"
        }
      ]
    }
  },
  "rules": {
    "calculate modulo 256 via x86 assembly": {
      "meta": {
        "name": "calculate modulo 256 via x86 assembly",
        "authors": [
          "moritz.raabe@mandiant.com"
        ],
        "scope": "instruction",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Data",
              "Modulo"
            ],
            "objective": "Data",
            "behavior": "Modulo",
            "method": "",
            "id": "C0058"
          }
        ],
        "references": [],
        "examples": [
          "9324D1A8AE37A36AE560C37448C9705A:0x4049A9"
        ],
        "description": "",
        "lib": true,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: calculate modulo 256 via x86 assembly\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n    lib: true\r\n    scope: instruction\r\n    mbc:\r\n      - Data::Modulo [C0058]\r\n    examples:\r\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\r\n  features:\r\n    #  and ecx, 800000FFh\r\n    #  and ecx, 0FFh\r\n    - and:\r\n      - mnemonic: and\r\n      - or:\r\n        - number: 0x800000FF\r\n        - number: 0xFF\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4198512
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "mnemonic",
                    "mnemonic": "and"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4198512
                  }
                ],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 2147483903
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 255
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4198512
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4198517
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "mnemonic",
                    "mnemonic": "and"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4198517
                  }
                ],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 2147483903
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 255
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4198517
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4198553
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "mnemonic",
                    "mnemonic": "and"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4198553
                  }
                ],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 2147483903
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 255
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4198553
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4198559
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "mnemonic",
                    "mnemonic": "and"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4198559
                  }
                ],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 2147483903
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 255
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4198559
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4198634
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "mnemonic",
                    "mnemonic": "and"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4198634
                  }
                ],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 2147483903
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 255
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4198634
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4198640
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "mnemonic",
                    "mnemonic": "and"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4198640
                  }
                ],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 2147483903
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 255
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4198640
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4198734
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "mnemonic",
                    "mnemonic": "and"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4198734
                  }
                ],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 2147483903
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 255
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4198734
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4198740
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "mnemonic",
                    "mnemonic": "and"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4198740
                  }
                ],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 2147483903
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 255
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4198740
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4198764
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "mnemonic",
                    "mnemonic": "and"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4198764
                  }
                ],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 2147483903
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 255
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4198764
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "create process on Windows": {
      "meta": {
        "name": "create process on Windows",
        "namespace": "host-interaction/process/create",
        "authors": [
          "moritz.raabe@mandiant.com"
        ],
        "scope": "basic block",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Process",
              "Create Process"
            ],
            "objective": "Process",
            "behavior": "Create Process",
            "method": "",
            "id": "C0017"
          }
        ],
        "references": [],
        "examples": [
          "9324D1A8AE37A36AE560C37448C9705A:0x406DB0",
          "Practical Malware Analysis Lab 01-04.exe_:0x4011FC",
          "692f7fd6d198e804d6af98eb9e390d61:0x6000003"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: create process on Windows\r\n    namespace: host-interaction/process/create\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n    scope: basic block\r\n    mbc:\r\n      - Process::Create Process [C0017]\r\n    examples:\r\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\r\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\r\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\r\n  features:\r\n    - or:\r\n      - api: kernel32.WinExec\r\n      - api: kernel32.CreateProcess\r\n      - api: shell32.ShellExecute\r\n      - api: shell32.ShellExecuteEx\r\n      - api: advapi32.CreateProcessAsUser\r\n      - api: advapi32.CreateProcessWithLogon\r\n      - api: advapi32.CreateProcessWithToken\r\n      - api: kernel32.CreateProcessInternal\r\n      - api: ntdll.NtCreateUserProcess\r\n      - api: ntdll.NtCreateProcess\r\n      - api: ntdll.NtCreateProcessEx\r\n      - api: ntdll.ZwCreateProcess\r\n      - api: ZwCreateProcessEx\r\n      - api: ntdll.ZwCreateUserProcess\r\n      - api: ntdll.RtlCreateUserProcess\r\n      - api: System.Diagnostics.Process::Start\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4198848
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.WinExec"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.CreateProcess"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4199235
                  }
                ],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "shell32.ShellExecute"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "shell32.ShellExecuteEx"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "advapi32.CreateProcessAsUser"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "advapi32.CreateProcessWithLogon"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "advapi32.CreateProcessWithToken"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.CreateProcessInternal"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "ntdll.NtCreateUserProcess"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "ntdll.NtCreateProcess"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "ntdll.NtCreateProcessEx"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "ntdll.ZwCreateProcess"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "ZwCreateProcessEx"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "ntdll.ZwCreateUserProcess"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "ntdll.RtlCreateUserProcess"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Diagnostics.Process::Start"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4200674
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.WinExec"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.CreateProcess"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "shell32.ShellExecute"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "shell32.ShellExecuteEx"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4200833
                  }
                ],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "advapi32.CreateProcessAsUser"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "advapi32.CreateProcessWithLogon"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "advapi32.CreateProcessWithToken"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.CreateProcessInternal"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "ntdll.NtCreateUserProcess"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "ntdll.NtCreateProcess"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "ntdll.NtCreateProcessEx"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "ntdll.ZwCreateProcess"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "ZwCreateProcessEx"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "ntdll.ZwCreateUserProcess"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "ntdll.RtlCreateUserProcess"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Diagnostics.Process::Start"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "create process suspended": {
      "meta": {
        "name": "create process suspended",
        "namespace": "host-interaction/process/create",
        "authors": [
          "william.ballenthin@mandiant.com"
        ],
        "scope": "basic block",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Process",
              "Create Process",
              "Create Suspended Process"
            ],
            "objective": "Process",
            "behavior": "Create Process",
            "method": "Create Suspended Process",
            "id": "C0017.003"
          }
        ],
        "references": [],
        "examples": [
          "Practical Malware Analysis Lab 03-03.exe_:0x4010EA"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: create process suspended\r\n    namespace: host-interaction/process/create\r\n    authors:\r\n      - william.ballenthin@mandiant.com\r\n    scope: basic block\r\n    mbc:\r\n      - Process::Create Process::Create Suspended Process [C0017.003]\r\n    examples:\r\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\r\n  features:\r\n    - and:\r\n      - or:\r\n        - number: 0x08000004 = CREATE_NO_WINDOW | CREATE_SUSPENDED\r\n        - number: 4 = CREATE_SUSPENDED\r\n      - or:\r\n        - api: kernel32.CreateProcess\r\n        - api: advapi32.CreateProcessAsUser\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4198848
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 134217732,
                        "description": "CREATE_NO_WINDOW | CREATE_SUSPENDED"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 4,
                        "description": "CREATE_SUSPENDED"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4199029
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "kernel32.CreateProcess"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4199235
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "advapi32.CreateProcessAsUser"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "create thread": {
      "meta": {
        "name": "create thread",
        "namespace": "host-interaction/thread/create",
        "authors": [
          "moritz.raabe@mandiant.com",
          "michael.hunhoff@mandiant.com",
          "joakim@intezer.com",
          "anushka.virgaonkar@mandiant.com"
        ],
        "scope": "basic block",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Process",
              "Create Thread"
            ],
            "objective": "Process",
            "behavior": "Create Thread",
            "method": "",
            "id": "C0038"
          }
        ],
        "references": [],
        "examples": [
          "946A99F36A46D335DEC080D9A4371940:0x10001DA0",
          "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: create thread\r\n    namespace: host-interaction/thread/create\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - michael.hunhoff@mandiant.com\r\n      - joakim@intezer.com\r\n      - anushka.virgaonkar@mandiant.com\r\n    scope: basic block\r\n    mbc:\r\n      - Process::Create Thread [C0038]\r\n    examples:\r\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\r\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\r\n  features:\r\n    - or:\r\n      - and:\r\n        - os: windows\r\n        - or:\r\n          - api: kernel32.CreateThread\r\n          - api: _beginthread\r\n          - api: _beginthreadex\r\n          - api: PsCreateSystemThread\r\n          - api: SHCreateThread\r\n          - api: SHCreateThreadWithHandle\r\n          - api: kernel32.CreateRemoteThread\r\n          - api: kernel32.CreateRemoteThreadEx\r\n          - api: RtlCreateUserThread\r\n          - api: ntdll.NtCreateThread\r\n          - api: ntdll.NtCreateThreadEx\r\n          - api: ntdll.ZwCreateThread\r\n          - api: ntdll.ZwCreateThreadEx\r\n      - and:\r\n        - os: linux\r\n        - api: pthread_create\r\n      - and:\r\n        - api: System.Threading.Thread::Start\r\n        - optional:\r\n          - api: System.Threading.Thread::ctor\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4199274
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "linux"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "pthread_create"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Threading.Thread::Start"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "optional"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "System.Threading.Thread::ctor"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "windows"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "no address"
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.CreateThread"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4199317
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "_beginthread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "_beginthreadex"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "PsCreateSystemThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "SHCreateThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "SHCreateThreadWithHandle"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.CreateRemoteThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.CreateRemoteThreadEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "RtlCreateUserThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "ntdll.NtCreateThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "ntdll.NtCreateThreadEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "ntdll.ZwCreateThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "ntdll.ZwCreateThreadEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4199354
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "linux"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "pthread_create"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Threading.Thread::Start"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "optional"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "System.Threading.Thread::ctor"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "windows"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "no address"
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.CreateThread"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4199383
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "_beginthread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "_beginthreadex"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "PsCreateSystemThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "SHCreateThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "SHCreateThreadWithHandle"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.CreateRemoteThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.CreateRemoteThreadEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "RtlCreateUserThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "ntdll.NtCreateThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "ntdll.NtCreateThreadEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "ntdll.ZwCreateThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "ntdll.ZwCreateThreadEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "terminate thread": {
      "meta": {
        "name": "terminate thread",
        "namespace": "host-interaction/thread/terminate",
        "authors": [
          "moritz.raabe@mandiant.com",
          "michael.hunhoff@mandiant.com",
          "anushka.virgaonkar@mandiant.com"
        ],
        "scope": "basic block",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Process",
              "Terminate Thread"
            ],
            "objective": "Process",
            "behavior": "Terminate Thread",
            "method": "",
            "id": "C0039"
          }
        ],
        "references": [],
        "examples": [
          "Practical Malware Analysis Lab 03-02.dll_:0x10003286",
          "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x407E90"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: terminate thread\r\n    namespace: host-interaction/thread/terminate\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - michael.hunhoff@mandiant.com\r\n      - anushka.virgaonkar@mandiant.com\r\n    scope: basic block\r\n    mbc:\r\n      - Process::Terminate Thread [C0039]\r\n    examples:\r\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003286\r\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x407E90\r\n  features:\r\n    - or:\r\n      - api: kernel32.TerminateThread\r\n      - api: PsTerminateSystemThread\r\n      - api: System.Threading.Thread.Abort\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4199326
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.TerminateThread"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4199328
                  }
                ],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "PsTerminateSystemThread"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Threading.Thread.Abort"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4199392
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.TerminateThread"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4199394
                  }
                ],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "PsTerminateSystemThread"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Threading.Thread.Abort"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4199467
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.TerminateThread"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4199485
                  },
                  {
                    "type": "absolute",
                    "value": 4199478
                  }
                ],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "PsTerminateSystemThread"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Threading.Thread.Abort"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4199489
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.TerminateThread"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4199494
                  }
                ],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "PsTerminateSystemThread"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Threading.Thread.Abort"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4199508
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.TerminateThread"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4199513
                  }
                ],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "PsTerminateSystemThread"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Threading.Thread.Abort"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "delay execution": {
      "meta": {
        "name": "delay execution",
        "authors": [
          "michael.hunhoff@mandiant.com",
          "@ramen0x3f"
        ],
        "scope": "basic block",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Anti-Behavioral Analysis",
              "Dynamic Analysis Evasion",
              "Delayed Execution"
            ],
            "objective": "Anti-Behavioral Analysis",
            "behavior": "Dynamic Analysis Evasion",
            "method": "Delayed Execution",
            "id": "B0003.003"
          }
        ],
        "references": [
          "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions",
          "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
        ],
        "examples": [
          "al-khaser_x86.exe_:0x449770",
          "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6"
        ],
        "description": "",
        "lib": true,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: delay execution\r\n    authors:\r\n      - michael.hunhoff@mandiant.com\r\n      - \"@ramen0x3f\"\r\n    lib: true\r\n    scope: basic block\r\n    mbc:\r\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\r\n    references:\r\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\r\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\r\n    examples:\r\n      - al-khaser_x86.exe_:0x449770\r\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\r\n  features:\r\n    - or:\r\n      - and:\r\n        - os: windows\r\n        - or:\r\n          - api: kernel32.Sleep\r\n          - api: kernel32.SleepEx\r\n          - api: kernel32.WaitForSingleObject\r\n          - api: kernel32.SignalObjectAndWait\r\n          - api: kernel32.WaitForSingleObjectEx\r\n          - api: kernel32.WaitForMultipleObjects\r\n          - api: kernel32.WaitForMultipleObjectsEx\r\n          - api: kernel32.RegisterWaitForSingleObject\r\n          - api: WaitOnAddress\r\n          - api: user32.MsgWaitForMultipleObjects\r\n          - api: user32.MsgWaitForMultipleObjectsEx\r\n          - api: NtDelayExecution\r\n          - api: KeWaitForSingleObject\r\n          - api: KeDelayExecutionThread\r\n      - and:\r\n        - os: linux\r\n        - or:\r\n          - api: sleep\r\n          - api: usleep\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4199354
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "linux"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "sleep"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "usleep"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "windows"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "no address"
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.Sleep"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4199359
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.SleepEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.SignalObjectAndWait"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForSingleObjectEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForMultipleObjects"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForMultipleObjectsEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.RegisterWaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "WaitOnAddress"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "user32.MsgWaitForMultipleObjects"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "user32.MsgWaitForMultipleObjectsEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "NtDelayExecution"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "KeWaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "KeDelayExecutionThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4199420
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "linux"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "sleep"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "usleep"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "windows"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "no address"
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.Sleep"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.SleepEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.SignalObjectAndWait"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForSingleObjectEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForMultipleObjects"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4199451
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForMultipleObjectsEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.RegisterWaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "WaitOnAddress"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "user32.MsgWaitForMultipleObjects"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "user32.MsgWaitForMultipleObjectsEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "NtDelayExecution"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "KeWaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "KeDelayExecutionThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4199793
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "linux"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "sleep"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "usleep"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "windows"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "no address"
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.Sleep"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4199798
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.SleepEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.SignalObjectAndWait"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForSingleObjectEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForMultipleObjects"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForMultipleObjectsEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.RegisterWaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "WaitOnAddress"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "user32.MsgWaitForMultipleObjects"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "user32.MsgWaitForMultipleObjectsEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "NtDelayExecution"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "KeWaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "KeDelayExecutionThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4199805
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "linux"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "sleep"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "usleep"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "windows"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "no address"
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.Sleep"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4199805
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.SleepEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.SignalObjectAndWait"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForSingleObjectEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForMultipleObjects"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForMultipleObjectsEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.RegisterWaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "WaitOnAddress"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "user32.MsgWaitForMultipleObjects"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "user32.MsgWaitForMultipleObjectsEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "NtDelayExecution"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "KeWaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "KeDelayExecutionThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4200033
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "linux"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "sleep"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "usleep"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "windows"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "no address"
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.Sleep"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4200038
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.SleepEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.SignalObjectAndWait"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForSingleObjectEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForMultipleObjects"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForMultipleObjectsEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.RegisterWaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "WaitOnAddress"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "user32.MsgWaitForMultipleObjects"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "user32.MsgWaitForMultipleObjectsEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "NtDelayExecution"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "KeWaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "KeDelayExecutionThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4200177
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "linux"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "sleep"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "usleep"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "windows"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "no address"
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.Sleep"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4200177
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.SleepEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.SignalObjectAndWait"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForSingleObjectEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForMultipleObjects"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WaitForMultipleObjectsEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.RegisterWaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "WaitOnAddress"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "user32.MsgWaitForMultipleObjects"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "user32.MsgWaitForMultipleObjectsEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "NtDelayExecution"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "KeWaitForSingleObject"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "KeDelayExecutionThread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "contain loop": {
      "meta": {
        "name": "contain loop",
        "authors": [
          "moritz.raabe@mandiant.com"
        ],
        "scope": "function",
        "attack": [],
        "mbc": [],
        "references": [],
        "examples": [
          "08AC667C65D36D6542917655571E61C8:0x406EAA"
        ],
        "description": "",
        "lib": true,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: contain loop\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n    lib: true\r\n    scope: function\r\n    examples:\r\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\r\n  features:\r\n    - or:\r\n      - characteristic: loop\r\n      - characteristic: tight loop\r\n      - characteristic: recursive call\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4198400
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "characteristic",
                    "characteristic": "loop"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4198400
                  }
                ],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "characteristic",
                    "characteristic": "tight loop"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "characteristic",
                    "characteristic": "recursive call"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4199616
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "characteristic",
                    "characteristic": "loop"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4199616
                  }
                ],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "characteristic",
                    "characteristic": "tight loop"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "characteristic",
                    "characteristic": "recursive call"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "encode data using Base64": {
      "meta": {
        "name": "encode data using Base64",
        "namespace": "data-manipulation/encoding/base64",
        "authors": [
          "moritz.raabe@mandiant.com",
          "anushka.virgaonkar@mandiant.com",
          "michael.hunhoff@mandiant.com"
        ],
        "scope": "function",
        "attack": [
          {
            "parts": [
              "Defense Evasion",
              "Obfuscated Files or Information"
            ],
            "tactic": "Defense Evasion",
            "technique": "Obfuscated Files or Information",
            "subtechnique": "",
            "id": "T1027"
          }
        ],
        "mbc": [
          {
            "parts": [
              "Defense Evasion",
              "Obfuscated Files or Information",
              "Encoding-Standard Algorithm"
            ],
            "objective": "Defense Evasion",
            "behavior": "Obfuscated Files or Information",
            "method": "Encoding-Standard Algorithm",
            "id": "E1027.m02"
          },
          {
            "parts": [
              "Data",
              "Encode Data",
              "Base64"
            ],
            "objective": "Data",
            "behavior": "Encode Data",
            "method": "Base64",
            "id": "C0026.001"
          }
        ],
        "references": [],
        "examples": [
          "BFB9B5391A13D0AFD787E87AB90F14F5:0x1314889C",
          "074072B261FC27B65C72671F13510C05:0x100049B2",
          "5DB2D2BE20D59AA0BE6709A6850F1775:0x18001CC30",
          "08AC667C65D36D6542917655571E61C8:0x406EAA"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: encode data using Base64\r\n    namespace: data-manipulation/encoding/base64\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - anushka.virgaonkar@mandiant.com\r\n      - michael.hunhoff@mandiant.com\r\n    scope: function\r\n    att&ck:\r\n      - Defense Evasion::Obfuscated Files or Information [T1027]\r\n    mbc:\r\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\r\n      - Data::Encode Data::Base64 [C0026.001]\r\n    examples:\r\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314889C\r\n      - 074072B261FC27B65C72671F13510C05:0x100049B2\r\n      - 5DB2D2BE20D59AA0BE6709A6850F1775:0x18001CC30\r\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\r\n  features:\r\n    - or:\r\n      - and:\r\n        - mnemonic: shl\r\n        - mnemonic: shr\r\n        - number: 0x3F = modulo 64\r\n        - or:\r\n          - number: 0x3D = '='\r\n          - number: 0x3D3D = '=='\r\n        - match: contain loop\r\n        - optional:\r\n          - number: 2\r\n          - number: 3\r\n          - number: 4\r\n          - number: 6\r\n          - number: 0xF\r\n          - string: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\r\n      - api: System.Convert::ToBase64String\r\n      - api: System.Convert::ToBase64CharArray\r\n      - api: System.Convert::TryToBase64Chars\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4198400
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Convert::ToBase64String"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Convert::ToBase64CharArray"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Convert::TryToBase64Chars"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "mnemonic",
                        "mnemonic": "shl"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4198707
                      },
                      {
                        "type": "absolute",
                        "value": 4198485
                      },
                      {
                        "type": "absolute",
                        "value": 4198469
                      },
                      {
                        "type": "absolute",
                        "value": 4198615
                      },
                      {
                        "type": "absolute",
                        "value": 4198715
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "mnemonic",
                        "mnemonic": "shr"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4198612
                      },
                      {
                        "type": "absolute",
                        "value": 4198693
                      },
                      {
                        "type": "absolute",
                        "value": 4198710
                      },
                      {
                        "type": "absolute",
                        "value": 4198472
                      },
                      {
                        "type": "absolute",
                        "value": 4198488
                      },
                      {
                        "type": "absolute",
                        "value": 4198460
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 63,
                        "description": "modulo 64"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4198493
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "number",
                            "number": 61,
                            "description": "'='"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4198426
                          },
                          {
                            "type": "absolute",
                            "value": 4198526
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "number",
                            "number": 15677,
                            "description": "'=='"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "match",
                        "match": "contain loop"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "or"
                          }
                        },
                        "children": [
                          {
                            "success": true,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "characteristic",
                                "characteristic": "loop"
                              }
                            },
                            "children": [],
                            "locations": [
                              {
                                "type": "absolute",
                                "value": 4198400
                              }
                            ],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "characteristic",
                                "characteristic": "tight loop"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "characteristic",
                                "characteristic": "recursive call"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4198400
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "optional"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "number",
                            "number": 2
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4198715
                          },
                          {
                            "type": "absolute",
                            "value": 4198612
                          },
                          {
                            "type": "absolute",
                            "value": 4198485
                          },
                          {
                            "type": "absolute",
                            "value": 4198772
                          },
                          {
                            "type": "absolute",
                            "value": 4198693
                          },
                          {
                            "type": "absolute",
                            "value": 4198683
                          },
                          {
                            "type": "absolute",
                            "value": 4198460
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "number",
                            "number": 3
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4198609
                          },
                          {
                            "type": "absolute",
                            "value": 4198440
                          },
                          {
                            "type": "absolute",
                            "value": 4198457
                          },
                          {
                            "type": "absolute",
                            "value": 4198523
                          },
                          {
                            "type": "absolute",
                            "value": 4198700
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "number",
                            "number": 4
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4198707
                          },
                          {
                            "type": "absolute",
                            "value": 4198564
                          },
                          {
                            "type": "absolute",
                            "value": 4198469
                          },
                          {
                            "type": "absolute",
                            "value": 4198710
                          },
                          {
                            "type": "absolute",
                            "value": 4198615
                          },
                          {
                            "type": "absolute",
                            "value": 4198472
                          },
                          {
                            "type": "absolute",
                            "value": 4198787
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "number",
                            "number": 6
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4198488
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "number",
                            "number": 15
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4198705
                          },
                          {
                            "type": "absolute",
                            "value": 4198477
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "string",
                            "string": "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "create pipe": {
      "meta": {
        "name": "create pipe",
        "namespace": "communication/named-pipe/create",
        "authors": [
          "moritz.raabe@mandiant.com",
          "michael.hunhoff@mandiant.com"
        ],
        "scope": "function",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Communication",
              "Interprocess Communication",
              "Create Pipe"
            ],
            "objective": "Communication",
            "behavior": "Interprocess Communication",
            "method": "Create Pipe",
            "id": "C0003.001"
          }
        ],
        "references": [],
        "examples": [
          "Practical Malware Analysis Lab 03-02.dll_:0x10003a13"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: create pipe\r\n    namespace: communication/named-pipe/create\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - michael.hunhoff@mandiant.com\r\n    scope: function\r\n    mbc:\r\n      - Communication::Interprocess Communication::Create Pipe [C0003.001]\r\n    examples:\r\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003a13\r\n  features:\r\n    - or:\r\n      - api: kernel32.CreatePipe\r\n      - api: kernel32.CreateNamedPipe\r\n      - api: System.IO.Pipes.AnonymousPipeClientStream::ctor\r\n      - api: System.IO.Pipes.NamedPipeClientStream::ctor\r\n      - api: System.IO.Pipes.AnonymousPipeServerStream::ctor\r\n      - api: System.IO.Pipes.AnonymousPipeServerStreamAcl::Create\r\n      - api: System.IO.Pipes.NamedPipeServerStream::ctor\r\n      - api: System.IO.Pipes.NamedPipeServerStreamAcl::Create\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4198848
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.CreatePipe"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4199040
                  },
                  {
                    "type": "absolute",
                    "value": 4199023
                  }
                ],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.CreateNamedPipe"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.Pipes.AnonymousPipeClientStream::ctor"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.Pipes.NamedPipeClientStream::ctor"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.Pipes.AnonymousPipeServerStream::ctor"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.Pipes.AnonymousPipeServerStreamAcl::Create"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.Pipes.NamedPipeServerStream::ctor"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.Pipes.NamedPipeServerStreamAcl::Create"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "create two anonymous pipes": {
      "meta": {
        "name": "create two anonymous pipes",
        "namespace": "communication/named-pipe/create",
        "authors": [
          "matthew.williams@mandiant.com"
        ],
        "scope": "function",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Communication",
              "Interprocess Communication",
              "Create Pipe"
            ],
            "objective": "Communication",
            "behavior": "Interprocess Communication",
            "method": "Create Pipe",
            "id": "C0003.001"
          }
        ],
        "references": [],
        "examples": [
          "Practical Malware Analysis Lab 14-02.exe_:0x4011C0"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: create two anonymous pipes\r\n    namespace: communication/named-pipe/create\r\n    authors:\r\n      - matthew.williams@mandiant.com\r\n    scope: function\r\n    mbc:\r\n      - Communication::Interprocess Communication::Create Pipe [C0003.001]\r\n    examples:\r\n      - Practical Malware Analysis Lab 14-02.exe_:0x4011C0\r\n  features:\r\n    - and:\r\n      - count(api(CreatePipe)): 2\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4198848
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "range",
                    "min": 2,
                    "max": 2,
                    "child": {
                      "type": "api",
                      "api": "CreatePipe"
                    }
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4199040
                  },
                  {
                    "type": "absolute",
                    "value": 4199023
                  }
                ],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "create a process with modified I/O handles and window": {
      "meta": {
        "name": "create a process with modified I/O handles and window",
        "namespace": "host-interaction/process/create",
        "authors": [
          "matthew.williams@mandiant.com",
          "anushka.virgaonkar@mandiant.com"
        ],
        "scope": "function",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Process",
              "Create Process"
            ],
            "objective": "Process",
            "behavior": "Create Process",
            "method": "",
            "id": "C0017"
          }
        ],
        "references": [
          "https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa"
        ],
        "examples": [
          "Practical Malware Analysis Lab 14-02.exe_:0x4011C0"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: create a process with modified I/O handles and window\r\n    namespace: host-interaction/process/create\r\n    authors:\r\n      - matthew.williams@mandiant.com\r\n      - anushka.virgaonkar@mandiant.com\r\n    scope: function\r\n    mbc:\r\n      - Process::Create Process [C0017]\r\n    references:\r\n      - https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa\r\n    examples:\r\n      - Practical Malware Analysis Lab 14-02.exe_:0x4011C0\r\n  features:\r\n    - or:\r\n      - and:\r\n        - or:\r\n          - description: API functions that accept a pointer to a STARTUPINFO structure\r\n          - api: kernel32.CreateProcess\r\n          - api: kernel32.CreateProcessInternal\r\n          - api: advapi32.CreateProcessAsUser\r\n          - api: advapi32.CreateProcessWithLogon\r\n          - api: advapi32.CreateProcessWithToken\r\n        - number: 0x101 = STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW\r\n          # STARTF_USESTDHANDLES indicates the hStdInput, hStdOutput, and hStdError members contain additional information\r\n          # STARTF_USESHOWWINDOW indicates the wShowWindow member contains additional information\r\n        - or:\r\n          - and:\r\n            - arch: i386\r\n            - number: 0x44 = StartupInfo.cb (size)\r\n          - and:\r\n            - arch: amd64\r\n            - number: 0x68 = StartupInfo.cb (size)\r\n          # STARTUPINFOEX size values not currently supported by this rule.\r\n        - optional:\r\n          - api: kernel32.GetStartupInfo\r\n      - and:\r\n        - api: System.Diagnostics.Process::Start\r\n        - or:\r\n          - property/write: System.Diagnostics.ProcessStartInfo::UseShellExecute\r\n          - property/write: System.Diagnostics.ProcessStartInfo::Verb\r\n          - property/write: System.Diagnostics.ProcessStartInfo::WindowStyle\r\n          - property/write: System.Diagnostics.ProcessStartInfo::WorkingDirectory\r\n          - property/write: System.Diagnostics.ProcessStartInfo::FileName\r\n          - property/write: System.Diagnostics.ProcessStartInfo::Arguments\r\n          - property/write: System.Diagnostics.ProcessStartInfo::CreateNoWindow\r\n          - property/write: System.Diagnostics.ProcessStartInfo::RedirectStandardOutput\r\n          - property/write: System.Diagnostics.ProcessStartInfo::RedirectStandardInput\r\n          - property/read: System.Diagnostics.Process::StandardOutput\r\n          - property/read: System.Diagnostics.Process::StandardInput\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4198848
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Diagnostics.Process::Start"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "property",
                            "access": "write",
                            "property": "System.Diagnostics.ProcessStartInfo::UseShellExecute"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "property",
                            "access": "write",
                            "property": "System.Diagnostics.ProcessStartInfo::Verb"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "property",
                            "access": "write",
                            "property": "System.Diagnostics.ProcessStartInfo::WindowStyle"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "property",
                            "access": "write",
                            "property": "System.Diagnostics.ProcessStartInfo::WorkingDirectory"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "property",
                            "access": "write",
                            "property": "System.Diagnostics.ProcessStartInfo::FileName"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "property",
                            "access": "write",
                            "property": "System.Diagnostics.ProcessStartInfo::Arguments"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "property",
                            "access": "write",
                            "property": "System.Diagnostics.ProcessStartInfo::CreateNoWindow"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "property",
                            "access": "write",
                            "property": "System.Diagnostics.ProcessStartInfo::RedirectStandardOutput"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "property",
                            "access": "write",
                            "property": "System.Diagnostics.ProcessStartInfo::RedirectStandardInput"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "property",
                            "access": "read",
                            "property": "System.Diagnostics.Process::StandardOutput"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "property",
                            "access": "read",
                            "property": "System.Diagnostics.Process::StandardInput"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or",
                        "description": "API functions that accept a pointer to a STARTUPINFO structure"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.CreateProcess"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4199235
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.CreateProcessInternal"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "advapi32.CreateProcessAsUser"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "advapi32.CreateProcessWithLogon"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "advapi32.CreateProcessWithToken"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "number",
                        "number": 257,
                        "description": "STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4199096
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "and"
                          }
                        },
                        "children": [
                          {
                            "success": true,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "arch",
                                "arch": "i386"
                              }
                            },
                            "children": [],
                            "locations": [
                              {
                                "type": "no address"
                              }
                            ],
                            "captures": {}
                          },
                          {
                            "success": true,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "number",
                                "number": 68,
                                "description": "StartupInfo.cb (size)"
                              }
                            },
                            "children": [],
                            "locations": [
                              {
                                "type": "absolute",
                                "value": 4199042
                              }
                            ],
                            "captures": {}
                          }
                        ],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "and"
                          }
                        },
                        "children": [
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "arch",
                                "arch": "amd64"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "number",
                                "number": 104,
                                "description": "StartupInfo.cb (size)"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "optional"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.GetStartupInfo"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "execute shell command and capture output": {
      "meta": {
        "name": "execute shell command and capture output",
        "namespace": "communication/c2/shell",
        "authors": [
          "matthew.williams@mandiant.com"
        ],
        "scope": "function",
        "attack": [
          {
            "parts": [
              "Execution",
              "Command and Scripting Interpreter",
              "Windows Command Shell"
            ],
            "tactic": "Execution",
            "technique": "Command and Scripting Interpreter",
            "subtechnique": "Windows Command Shell",
            "id": "T1059.003"
          }
        ],
        "mbc": [],
        "references": [
          "https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa"
        ],
        "examples": [
          "Practical Malware Analysis Lab 14-02.exe_:0x4011C0"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: execute shell command and capture output\r\n    namespace: communication/c2/shell\r\n    authors:\r\n      - matthew.williams@mandiant.com\r\n    scope: function\r\n    att&ck:\r\n      - Execution::Command and Scripting Interpreter::Windows Command Shell [T1059.003]\r\n    references:\r\n      - https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa\r\n    examples:\r\n      - Practical Malware Analysis Lab 14-02.exe_:0x4011C0\r\n  features:\r\n    - and:\r\n      - match: create a process with modified I/O handles and window\r\n      - match: create pipe\r\n      - or:\r\n        - match: get COMSPEC environment variable\r\n        - string: \"\\\\cmd.exe\"\r\n        - string: \"cmd.exe\"\r\n        - string: \"cmd.exe /c \"\r\n        - string: \"C:\\\\Windows\\\\system32\\\\cmd.exe\"\r\n      - optional:\r\n        - api: kernel32.GetSystemDirectory\r\n        - api: kernel32.SetCurrentDirectory\r\n        - match: create thread\r\n        - match: read pipe\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4198848
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "match",
                    "match": "create a process with modified I/O handles and window"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "and"
                          }
                        },
                        "children": [
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "System.Diagnostics.Process::Start"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "or"
                              }
                            },
                            "children": [
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "property",
                                    "access": "write",
                                    "property": "System.Diagnostics.ProcessStartInfo::UseShellExecute"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "property",
                                    "access": "write",
                                    "property": "System.Diagnostics.ProcessStartInfo::Verb"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "property",
                                    "access": "write",
                                    "property": "System.Diagnostics.ProcessStartInfo::WindowStyle"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "property",
                                    "access": "write",
                                    "property": "System.Diagnostics.ProcessStartInfo::WorkingDirectory"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "property",
                                    "access": "write",
                                    "property": "System.Diagnostics.ProcessStartInfo::FileName"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "property",
                                    "access": "write",
                                    "property": "System.Diagnostics.ProcessStartInfo::Arguments"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "property",
                                    "access": "write",
                                    "property": "System.Diagnostics.ProcessStartInfo::CreateNoWindow"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "property",
                                    "access": "write",
                                    "property": "System.Diagnostics.ProcessStartInfo::RedirectStandardOutput"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "property",
                                    "access": "write",
                                    "property": "System.Diagnostics.ProcessStartInfo::RedirectStandardInput"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "property",
                                    "access": "read",
                                    "property": "System.Diagnostics.Process::StandardOutput"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "property",
                                    "access": "read",
                                    "property": "System.Diagnostics.Process::StandardInput"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": true,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "and"
                          }
                        },
                        "children": [
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "or",
                                "description": "API functions that accept a pointer to a STARTUPINFO structure"
                              }
                            },
                            "children": [
                              {
                                "success": true,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "kernel32.CreateProcess"
                                  }
                                },
                                "children": [],
                                "locations": [
                                  {
                                    "type": "absolute",
                                    "value": 4199235
                                  }
                                ],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "kernel32.CreateProcessInternal"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "advapi32.CreateProcessAsUser"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "advapi32.CreateProcessWithLogon"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "advapi32.CreateProcessWithToken"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": true,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "number",
                                "number": 257,
                                "description": "STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW"
                              }
                            },
                            "children": [],
                            "locations": [
                              {
                                "type": "absolute",
                                "value": 4199096
                              }
                            ],
                            "captures": {}
                          },
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "or"
                              }
                            },
                            "children": [
                              {
                                "success": true,
                                "node": {
                                  "type": "statement",
                                  "statement": {
                                    "type": "and"
                                  }
                                },
                                "children": [
                                  {
                                    "success": true,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "arch",
                                        "arch": "i386"
                                      }
                                    },
                                    "children": [],
                                    "locations": [
                                      {
                                        "type": "no address"
                                      }
                                    ],
                                    "captures": {}
                                  },
                                  {
                                    "success": true,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "number",
                                        "number": 68,
                                        "description": "StartupInfo.cb (size)"
                                      }
                                    },
                                    "children": [],
                                    "locations": [
                                      {
                                        "type": "absolute",
                                        "value": 4199042
                                      }
                                    ],
                                    "captures": {}
                                  }
                                ],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "statement",
                                  "statement": {
                                    "type": "and"
                                  }
                                },
                                "children": [
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "arch",
                                        "arch": "amd64"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "number",
                                        "number": 104,
                                        "description": "StartupInfo.cb (size)"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  }
                                ],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "optional"
                              }
                            },
                            "children": [
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "kernel32.GetStartupInfo"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4198848
                  }
                ],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "match",
                    "match": "create pipe"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.CreatePipe"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4199040
                          },
                          {
                            "type": "absolute",
                            "value": 4199023
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.CreateNamedPipe"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "System.IO.Pipes.AnonymousPipeClientStream::ctor"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "System.IO.Pipes.NamedPipeClientStream::ctor"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "System.IO.Pipes.AnonymousPipeServerStream::ctor"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "System.IO.Pipes.AnonymousPipeServerStreamAcl::Create"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "System.IO.Pipes.NamedPipeServerStream::ctor"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "System.IO.Pipes.NamedPipeServerStreamAcl::Create"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4198848
                  }
                ],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "optional"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "kernel32.GetSystemDirectory"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "kernel32.SetCurrentDirectory"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "match",
                        "match": "create thread"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "or"
                          }
                        },
                        "children": [
                          {
                            "success": false,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "and"
                              }
                            },
                            "children": [
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "os",
                                    "os": "linux"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "pthread_create"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "and"
                              }
                            },
                            "children": [
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "System.Threading.Thread::Start"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": true,
                                "node": {
                                  "type": "statement",
                                  "statement": {
                                    "type": "optional"
                                  }
                                },
                                "children": [
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "System.Threading.Thread::ctor"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  }
                                ],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "and"
                              }
                            },
                            "children": [
                              {
                                "success": true,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "os",
                                    "os": "windows"
                                  }
                                },
                                "children": [],
                                "locations": [
                                  {
                                    "type": "no address"
                                  }
                                ],
                                "captures": {}
                              },
                              {
                                "success": true,
                                "node": {
                                  "type": "statement",
                                  "statement": {
                                    "type": "or"
                                  }
                                },
                                "children": [
                                  {
                                    "success": true,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "kernel32.CreateThread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [
                                      {
                                        "type": "absolute",
                                        "value": 4199383
                                      }
                                    ],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "_beginthread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "_beginthreadex"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "PsCreateSystemThread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "SHCreateThread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "SHCreateThreadWithHandle"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "kernel32.CreateRemoteThread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "kernel32.CreateRemoteThreadEx"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "RtlCreateUserThread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "ntdll.NtCreateThread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "ntdll.NtCreateThreadEx"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "ntdll.ZwCreateThread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "ntdll.ZwCreateThreadEx"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  }
                                ],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": true,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "or"
                          }
                        },
                        "children": [
                          {
                            "success": false,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "and"
                              }
                            },
                            "children": [
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "os",
                                    "os": "linux"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "pthread_create"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "and"
                              }
                            },
                            "children": [
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "System.Threading.Thread::Start"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": true,
                                "node": {
                                  "type": "statement",
                                  "statement": {
                                    "type": "optional"
                                  }
                                },
                                "children": [
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "System.Threading.Thread::ctor"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  }
                                ],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "and"
                              }
                            },
                            "children": [
                              {
                                "success": true,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "os",
                                    "os": "windows"
                                  }
                                },
                                "children": [],
                                "locations": [
                                  {
                                    "type": "no address"
                                  }
                                ],
                                "captures": {}
                              },
                              {
                                "success": true,
                                "node": {
                                  "type": "statement",
                                  "statement": {
                                    "type": "or"
                                  }
                                },
                                "children": [
                                  {
                                    "success": true,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "kernel32.CreateThread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [
                                      {
                                        "type": "absolute",
                                        "value": 4199317
                                      }
                                    ],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "_beginthread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "_beginthreadex"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "PsCreateSystemThread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "SHCreateThread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "SHCreateThreadWithHandle"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "kernel32.CreateRemoteThread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "kernel32.CreateRemoteThreadEx"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "RtlCreateUserThread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "ntdll.NtCreateThread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "ntdll.NtCreateThreadEx"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "ntdll.ZwCreateThread"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "ntdll.ZwCreateThreadEx"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  }
                                ],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4199354
                      },
                      {
                        "type": "absolute",
                        "value": 4199274
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "match",
                        "match": "read pipe"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "match",
                        "match": "get COMSPEC environment variable"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "string",
                        "string": "\\cmd.exe"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "string",
                        "string": "cmd.exe"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4199165
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "string",
                        "string": "cmd.exe /c "
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "string",
                        "string": "C:\\Windows\\system32\\cmd.exe"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "terminate process": {
      "meta": {
        "name": "terminate process",
        "namespace": "host-interaction/process/terminate",
        "authors": [
          "moritz.raabe@mandiant.com",
          "michael.hunhoff@mandiant.com",
          "anushka.virgaonkar@mandiant.com"
        ],
        "scope": "function",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Process",
              "Terminate Process"
            ],
            "objective": "Process",
            "behavior": "Terminate Process",
            "method": "",
            "id": "C0018"
          }
        ],
        "references": [],
        "examples": [
          "C91887D861D9BD4A5872249B641BC9F9:0x401A77",
          "9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: terminate process\r\n    namespace: host-interaction/process/terminate\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - michael.hunhoff@mandiant.com\r\n      - anushka.virgaonkar@mandiant.com\r\n    scope: function\r\n    mbc:\r\n      - Process::Terminate Process [C0018]\r\n    examples:\r\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\r\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\r\n  features:\r\n    - or:\r\n      - api: System.Diagnostics.Process::Kill\r\n      - api: System.Diagnostics.Process::WaitForExit\r\n      - api: System.Diagnostics.Process::WaitForExitAsync\r\n      - api: System.Environment::Exit\r\n      - api: System.Windows.Forms.Application::Exit\r\n      - and:\r\n        - optional:\r\n          - match: open process\r\n        - or:\r\n          - api: kernel32.TerminateProcess\r\n          - api: ntdll.NtTerminateProcess\r\n          - api: kernel32.ExitProcess\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4198848
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Diagnostics.Process::Kill"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Diagnostics.Process::WaitForExit"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Diagnostics.Process::WaitForExitAsync"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Environment::Exit"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Windows.Forms.Application::Exit"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "optional"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "match",
                            "match": "open process"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.TerminateProcess"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4199506
                          },
                          {
                            "type": "absolute",
                            "value": 4199525
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "ntdll.NtTerminateProcess"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.ExitProcess"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "read pipe": {
      "meta": {
        "name": "read pipe",
        "namespace": "communication/named-pipe/read",
        "authors": [
          "moritz.raabe@mandiant.com",
          "michael.hunhoff@mandiant.com"
        ],
        "scope": "function",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Communication",
              "Interprocess Communication",
              "Read Pipe"
            ],
            "objective": "Communication",
            "behavior": "Interprocess Communication",
            "method": "Read Pipe",
            "id": "C0003.003"
          }
        ],
        "references": [],
        "examples": [
          "Practical Malware Analysis Lab 14-02.exe_:0x4014C0"
        ],
        "description": "PeekNamedPipe isn't required to read from a pipe; however, pipes are often utilized to capture the output of a cmd.exe process. In a multi-thread instance, a new thread is created that calls PeekNamedPipe and ReadFile to obtain the command output.",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: read pipe\r\n    namespace: communication/named-pipe/read\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - michael.hunhoff@mandiant.com\r\n    description: PeekNamedPipe isn't required to read from a pipe; however, pipes are often utilized to capture the output of a cmd.exe process. In a multi-thread instance, a new thread is created that calls PeekNamedPipe and ReadFile to obtain the command output.\r\n    scope: function\r\n    mbc:\r\n      - Communication::Interprocess Communication::Read Pipe [C0003.003]\r\n    examples:\r\n      - Practical Malware Analysis Lab 14-02.exe_:0x4014C0\r\n  features:\r\n    - or:\r\n      - and:\r\n        - api: kernel32.PeekNamedPipe\r\n        - api: kernel32.ReadFile\r\n      - api: kernel32.TransactNamedPipe\r\n        description: writes and reads pipe in single operation\r\n      - api: kernel32.CallNamedPipe\r\n        description: connects, writes, and reads pipe in single operation\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4199616
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.TransactNamedPipe",
                    "description": "writes and reads pipe in single operation"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.CallNamedPipe",
                    "description": "connects, writes, and reads pipe in single operation"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "kernel32.PeekNamedPipe"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4199826
                      },
                      {
                        "type": "absolute",
                        "value": 4199710
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "kernel32.ReadFile"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4199750
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "read file on Windows": {
      "meta": {
        "name": "read file on Windows",
        "namespace": "host-interaction/file-system/read",
        "authors": [
          "moritz.raabe@mandiant.com",
          "anushka.virgaonkar@mandiant.com"
        ],
        "scope": "function",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "File System",
              "Read File"
            ],
            "objective": "File System",
            "behavior": "Read File",
            "method": "",
            "id": "C0051"
          }
        ],
        "references": [],
        "examples": [
          "BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: read file on Windows\r\n    namespace: host-interaction/file-system/read\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - anushka.virgaonkar@mandiant.com\r\n    scope: function\r\n    mbc:\r\n      - File System::Read File [C0051]\r\n    examples:\r\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\r\n  features:\r\n    - or:\r\n      - and:\r\n        - os: windows\r\n        - optional:\r\n          - and:\r\n            - number: 0x80000000 = GENERIC_READ\r\n            - match: create or open file\r\n        - or:\r\n          - api: kernel32.ReadFile\r\n          - api: ReadFileEx\r\n          - api: NtReadFile\r\n          - api: ZwReadFile\r\n          - api: LZRead\r\n          - api: _read\r\n          - api: fread\r\n      - api: System.IO.File::ReadAllBytes\r\n      - api: System.IO.File::ReadAllBytesAsync\r\n      - api: System.IO.File::ReadAllLines\r\n      - api: System.IO.File::ReadAllLinesAsync\r\n      - api: System.IO.File::ReadAllText\r\n      - api: System.IO.File::ReadAllTextAsync\r\n      - api: System.IO.File::ReadLines\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4199616
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::ReadAllBytes"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::ReadAllBytesAsync"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::ReadAllLines"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::ReadAllLinesAsync"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::ReadAllText"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::ReadAllTextAsync"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::ReadLines"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "windows"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "no address"
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "optional"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "and"
                          }
                        },
                        "children": [
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "number",
                                "number": 2147483648,
                                "description": "GENERIC_READ"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "match",
                                "match": "create or open file"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.ReadFile"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4199750
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "ReadFileEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "NtReadFile"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "ZwReadFile"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "LZRead"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "_read"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "fread"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "write file on Windows": {
      "meta": {
        "name": "write file on Windows",
        "namespace": "host-interaction/file-system/write",
        "authors": [
          "william.ballenthin@mandiant.com",
          "anushka.virgaonkar@mandiant.com"
        ],
        "scope": "function",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "File System",
              "Writes File"
            ],
            "objective": "File System",
            "behavior": "Writes File",
            "method": "",
            "id": "C0052"
          }
        ],
        "references": [],
        "examples": [
          "Practical Malware Analysis Lab 01-04.exe_:0x4011FC",
          "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: write file on Windows\r\n    namespace: host-interaction/file-system/write\r\n    authors:\r\n      - william.ballenthin@mandiant.com\r\n      - anushka.virgaonkar@mandiant.com\r\n    scope: function\r\n    mbc:\r\n      - File System::Writes File [C0052]\r\n    examples:\r\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\r\n      # ntdll\r\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\r\n  features:\r\n    - or:\r\n      - and:\r\n        - os: windows\r\n        - optional:\r\n          - basic block:\r\n            - or:\r\n              - number: 0x40000000 = GENERIC_WRITE\r\n              - number: 0x2 = FILE_WRITE_DATA\r\n              - match: create or open file\r\n        - or:\r\n          - api: kernel32.WriteFile\r\n          - api: kernel32.WriteFileEx\r\n          - api: NtWriteFile\r\n          - api: ZwWriteFile\r\n          - api: _fwrite\r\n          - api: fwrite\r\n      - api: System.IO.File::WriteAllBytes\r\n      - api: System.IO.File::WriteAllBytesAsync\r\n      - api: System.IO.File::WriteAllLines\r\n      - api: System.IO.File::WriteAllLinesAsync\r\n      - api: System.IO.File::WriteAllText\r\n      - api: System.IO.File::WriteAllTextAsync\r\n      - api: System.IO.File::AppendAllLines\r\n      - api: System.IO.File::AppendAllLinesAsync\r\n      - api: System.IO.File::AppendAllText\r\n      - api: System.IO.File::AppendAllTextAsync\r\n      - api: System.IO.File::AppendText\r\n      - api: System.IO.FileInfo::AppendText\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4199616
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::WriteAllBytes"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::WriteAllBytesAsync"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::WriteAllLines"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::WriteAllLinesAsync"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::WriteAllText"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::WriteAllTextAsync"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::AppendAllLines"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::AppendAllLinesAsync"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::AppendAllText"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::AppendAllTextAsync"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.File::AppendText"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.IO.FileInfo::AppendText"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "and"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "os",
                        "os": "windows"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "no address"
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "optional"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "subscope",
                            "scope": "basic block"
                          }
                        },
                        "children": [
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "or"
                              }
                            },
                            "children": [
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "number",
                                    "number": 1073741824,
                                    "description": "GENERIC_WRITE"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": true,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "number",
                                    "number": 2,
                                    "description": "FILE_WRITE_DATA"
                                  }
                                },
                                "children": [],
                                "locations": [
                                  {
                                    "type": "absolute",
                                    "value": 4200129
                                  }
                                ],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "match",
                                    "match": "create or open file"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "or"
                              }
                            },
                            "children": [
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "number",
                                    "number": 1073741824,
                                    "description": "GENERIC_WRITE"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": true,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "number",
                                    "number": 2,
                                    "description": "FILE_WRITE_DATA"
                                  }
                                },
                                "children": [],
                                "locations": [
                                  {
                                    "type": "absolute",
                                    "value": 4200010
                                  },
                                  {
                                    "type": "absolute",
                                    "value": 4200013
                                  }
                                ],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "match",
                                    "match": "create or open file"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "or"
                              }
                            },
                            "children": [
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "number",
                                    "number": 1073741824,
                                    "description": "GENERIC_WRITE"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": true,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "number",
                                    "number": 2,
                                    "description": "FILE_WRITE_DATA"
                                  }
                                },
                                "children": [],
                                "locations": [
                                  {
                                    "type": "absolute",
                                    "value": 4200070
                                  }
                                ],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "match",
                                    "match": "create or open file"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4200098
                          },
                          {
                            "type": "absolute",
                            "value": 4200010
                          },
                          {
                            "type": "absolute",
                            "value": 4200043
                          }
                        ],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WriteFile"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4200162
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.WriteFileEx"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "NtWriteFile"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "ZwWriteFile"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "_fwrite"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "fwrite"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "create HTTP request": {
      "meta": {
        "name": "create HTTP request",
        "namespace": "communication/http/client",
        "authors": [
          "michael.hunhoff@mandiant.com",
          "anushka.virgaonkar@mandiant.com"
        ],
        "scope": "function",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Communication",
              "HTTP Communication",
              "Create Request"
            ],
            "objective": "Communication",
            "behavior": "HTTP Communication",
            "method": "Create Request",
            "id": "C0002.012"
          }
        ],
        "references": [],
        "examples": [
          "6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: create HTTP request\r\n    namespace: communication/http/client\r\n    authors:\r\n      - michael.hunhoff@mandiant.com\r\n      - anushka.virgaonkar@mandiant.com\r\n    scope: function\r\n    mbc:\r\n      - Communication::HTTP Communication::Create Request [C0002.012]\r\n    examples:\r\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0\r\n  features:\r\n    - and:\r\n      - or:\r\n        - api: wininet.InternetOpen\r\n        - api: System.Net.WebRequest::Create\r\n        - api: System.Net.WebRequest::CreateDefault\r\n        - api: System.Net.WebRequest::CreateHttp\r\n      - optional:\r\n        - api: wininet.InternetCloseHandle\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4200272
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "optional"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "wininet.InternetCloseHandle"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4200434
                      },
                      {
                        "type": "absolute",
                        "value": 4200437
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "wininet.InternetOpen"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4200388
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Net.WebRequest::Create"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Net.WebRequest::CreateDefault"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Net.WebRequest::CreateHttp"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4200448
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "optional"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "wininet.InternetCloseHandle"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4200562
                      },
                      {
                        "type": "absolute",
                        "value": 4200565
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "wininet.InternetOpen"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4200464
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Net.WebRequest::Create"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Net.WebRequest::CreateDefault"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Net.WebRequest::CreateHttp"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "connect to URL": {
      "meta": {
        "name": "connect to URL",
        "namespace": "communication/http/client",
        "authors": [
          "michael.hunhoff@mandiant.com"
        ],
        "scope": "function",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Communication",
              "HTTP Communication",
              "Open URL"
            ],
            "objective": "Communication",
            "behavior": "HTTP Communication",
            "method": "Open URL",
            "id": "C0002.004"
          }
        ],
        "references": [],
        "examples": [
          "6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: connect to URL\r\n    namespace: communication/http/client\r\n    authors:\r\n      - michael.hunhoff@mandiant.com\r\n    scope: function\r\n    mbc:\r\n      - Communication::HTTP Communication::Open URL [C0002.004]\r\n    examples:\r\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0\r\n  features:\r\n    - and:\r\n      - optional:\r\n        - match: create HTTP request\r\n      - api: wininet.InternetOpenUrl\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4200272
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "wininet.InternetOpenUrl"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4200413
                  }
                ],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "optional"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "match",
                        "match": "create HTTP request"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "and"
                          }
                        },
                        "children": [
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "optional"
                              }
                            },
                            "children": [
                              {
                                "success": true,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "wininet.InternetCloseHandle"
                                  }
                                },
                                "children": [],
                                "locations": [
                                  {
                                    "type": "absolute",
                                    "value": 4200434
                                  },
                                  {
                                    "type": "absolute",
                                    "value": 4200437
                                  }
                                ],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "or"
                              }
                            },
                            "children": [
                              {
                                "success": true,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "wininet.InternetOpen"
                                  }
                                },
                                "children": [],
                                "locations": [
                                  {
                                    "type": "absolute",
                                    "value": 4200388
                                  }
                                ],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "System.Net.WebRequest::Create"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "System.Net.WebRequest::CreateDefault"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "System.Net.WebRequest::CreateHttp"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4200272
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ],
        [
          {
            "type": "absolute",
            "value": 4200448
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "wininet.InternetOpenUrl"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4200489
                  }
                ],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "optional"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "match",
                        "match": "create HTTP request"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "and"
                          }
                        },
                        "children": [
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "optional"
                              }
                            },
                            "children": [
                              {
                                "success": true,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "wininet.InternetCloseHandle"
                                  }
                                },
                                "children": [],
                                "locations": [
                                  {
                                    "type": "absolute",
                                    "value": 4200562
                                  },
                                  {
                                    "type": "absolute",
                                    "value": 4200565
                                  }
                                ],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "or"
                              }
                            },
                            "children": [
                              {
                                "success": true,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "wininet.InternetOpen"
                                  }
                                },
                                "children": [],
                                "locations": [
                                  {
                                    "type": "absolute",
                                    "value": 4200464
                                  }
                                ],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "System.Net.WebRequest::Create"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "System.Net.WebRequest::CreateDefault"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "System.Net.WebRequest::CreateHttp"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4200448
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "read data from Internet": {
      "meta": {
        "name": "read data from Internet",
        "namespace": "communication/http/client",
        "authors": [
          "michael.hunhoff@mandiant.com",
          "anushka.virgaonkar@mandiant.com"
        ],
        "scope": "function",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Communication",
              "HTTP Communication",
              "Get Response"
            ],
            "objective": "Communication",
            "behavior": "HTTP Communication",
            "method": "Get Response",
            "id": "C0002.017"
          }
        ],
        "references": [],
        "examples": [
          "6f99a2c8944cb02ff28c6f9ced59b161:0x40D590"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: read data from Internet\r\n    namespace: communication/http/client\r\n    authors:\r\n      - michael.hunhoff@mandiant.com\r\n      - anushka.virgaonkar@mandiant.com\r\n    scope: function\r\n    mbc:\r\n      - Communication::HTTP Communication::Get Response [C0002.017]\r\n    examples:\r\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40D590\r\n  features:\r\n    - and:\r\n      - optional:\r\n        - or:\r\n          - match: connect to HTTP server\r\n          - match: connect to URL\r\n      - or:\r\n        - api: wininet.InternetReadFile\r\n        - api: wininet.InternetReadFileEx\r\n        - api: System.Net.WebClient::DownloadString\r\n        - api: System.Net.WebClient::DownloadStringAsync\r\n        - api: System.Net.WebClient::DownloadStringTaskAsync\r\n        - api: System.Net.WebClient::DownloadData\r\n        - api: System.Net.WebClient::DownloadDataAsync\r\n        - api: System.Net.WebClient::DownloadDataTaskAsync\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4200448
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "optional"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "match",
                            "match": "connect to HTTP server"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "match",
                            "match": "connect to URL"
                          }
                        },
                        "children": [
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "and"
                              }
                            },
                            "children": [
                              {
                                "success": true,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "api",
                                    "api": "wininet.InternetOpenUrl"
                                  }
                                },
                                "children": [],
                                "locations": [
                                  {
                                    "type": "absolute",
                                    "value": 4200489
                                  }
                                ],
                                "captures": {}
                              },
                              {
                                "success": true,
                                "node": {
                                  "type": "statement",
                                  "statement": {
                                    "type": "optional"
                                  }
                                },
                                "children": [
                                  {
                                    "success": true,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "match",
                                        "match": "create HTTP request"
                                      }
                                    },
                                    "children": [
                                      {
                                        "success": true,
                                        "node": {
                                          "type": "statement",
                                          "statement": {
                                            "type": "and"
                                          }
                                        },
                                        "children": [
                                          {
                                            "success": true,
                                            "node": {
                                              "type": "statement",
                                              "statement": {
                                                "type": "optional"
                                              }
                                            },
                                            "children": [
                                              {
                                                "success": true,
                                                "node": {
                                                  "type": "feature",
                                                  "feature": {
                                                    "type": "api",
                                                    "api": "wininet.InternetCloseHandle"
                                                  }
                                                },
                                                "children": [],
                                                "locations": [
                                                  {
                                                    "type": "absolute",
                                                    "value": 4200562
                                                  },
                                                  {
                                                    "type": "absolute",
                                                    "value": 4200565
                                                  }
                                                ],
                                                "captures": {}
                                              }
                                            ],
                                            "locations": [],
                                            "captures": {}
                                          },
                                          {
                                            "success": true,
                                            "node": {
                                              "type": "statement",
                                              "statement": {
                                                "type": "or"
                                              }
                                            },
                                            "children": [
                                              {
                                                "success": true,
                                                "node": {
                                                  "type": "feature",
                                                  "feature": {
                                                    "type": "api",
                                                    "api": "wininet.InternetOpen"
                                                  }
                                                },
                                                "children": [],
                                                "locations": [
                                                  {
                                                    "type": "absolute",
                                                    "value": 4200464
                                                  }
                                                ],
                                                "captures": {}
                                              },
                                              {
                                                "success": false,
                                                "node": {
                                                  "type": "feature",
                                                  "feature": {
                                                    "type": "api",
                                                    "api": "System.Net.WebRequest::Create"
                                                  }
                                                },
                                                "children": [],
                                                "locations": [],
                                                "captures": {}
                                              },
                                              {
                                                "success": false,
                                                "node": {
                                                  "type": "feature",
                                                  "feature": {
                                                    "type": "api",
                                                    "api": "System.Net.WebRequest::CreateDefault"
                                                  }
                                                },
                                                "children": [],
                                                "locations": [],
                                                "captures": {}
                                              },
                                              {
                                                "success": false,
                                                "node": {
                                                  "type": "feature",
                                                  "feature": {
                                                    "type": "api",
                                                    "api": "System.Net.WebRequest::CreateHttp"
                                                  }
                                                },
                                                "children": [],
                                                "locations": [],
                                                "captures": {}
                                              }
                                            ],
                                            "locations": [],
                                            "captures": {}
                                          }
                                        ],
                                        "locations": [],
                                        "captures": {}
                                      }
                                    ],
                                    "locations": [
                                      {
                                        "type": "absolute",
                                        "value": 4200448
                                      }
                                    ],
                                    "captures": {}
                                  }
                                ],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4200448
                          }
                        ],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "wininet.InternetReadFile"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4200549
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "wininet.InternetReadFileEx"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Net.WebClient::DownloadString"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Net.WebClient::DownloadStringAsync"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Net.WebClient::DownloadStringTaskAsync"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Net.WebClient::DownloadData"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Net.WebClient::DownloadDataAsync"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "api",
                        "api": "System.Net.WebClient::DownloadDataTaskAsync"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "receive data": {
      "meta": {
        "name": "receive data",
        "namespace": "communication",
        "authors": [
          "william.ballenthin@mandiant.com"
        ],
        "scope": "function",
        "attack": [],
        "mbc": [
          {
            "parts": [
              "Command and Control",
              "C2 Communication",
              "Receive Data"
            ],
            "objective": "Command and Control",
            "behavior": "C2 Communication",
            "method": "Receive Data",
            "id": "B0030.002"
          }
        ],
        "references": [],
        "examples": [
          "BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60"
        ],
        "description": "all known techniques for receiving data from a potential C2 server",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: receive data\r\n    namespace: communication\r\n    authors:\r\n      - william.ballenthin@mandiant.com\r\n    description: all known techniques for receiving data from a potential C2 server\r\n    scope: function\r\n    mbc:\r\n      - Command and Control::C2 Communication::Receive Data [B0030.002]\r\n    examples:\r\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\r\n  features:\r\n    - or:\r\n      - match: receive data on socket\r\n      - match: read data from Internet\r\n      - match: download URL\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4200448
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "match",
                    "match": "receive data on socket"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "match",
                    "match": "read data from Internet"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "and"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "optional"
                          }
                        },
                        "children": [
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "or"
                              }
                            },
                            "children": [
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "match",
                                    "match": "connect to HTTP server"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              },
                              {
                                "success": true,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "match",
                                    "match": "connect to URL"
                                  }
                                },
                                "children": [
                                  {
                                    "success": true,
                                    "node": {
                                      "type": "statement",
                                      "statement": {
                                        "type": "and"
                                      }
                                    },
                                    "children": [
                                      {
                                        "success": true,
                                        "node": {
                                          "type": "feature",
                                          "feature": {
                                            "type": "api",
                                            "api": "wininet.InternetOpenUrl"
                                          }
                                        },
                                        "children": [],
                                        "locations": [
                                          {
                                            "type": "absolute",
                                            "value": 4200489
                                          }
                                        ],
                                        "captures": {}
                                      },
                                      {
                                        "success": true,
                                        "node": {
                                          "type": "statement",
                                          "statement": {
                                            "type": "optional"
                                          }
                                        },
                                        "children": [
                                          {
                                            "success": true,
                                            "node": {
                                              "type": "feature",
                                              "feature": {
                                                "type": "match",
                                                "match": "create HTTP request"
                                              }
                                            },
                                            "children": [
                                              {
                                                "success": true,
                                                "node": {
                                                  "type": "statement",
                                                  "statement": {
                                                    "type": "and"
                                                  }
                                                },
                                                "children": [
                                                  {
                                                    "success": true,
                                                    "node": {
                                                      "type": "statement",
                                                      "statement": {
                                                        "type": "optional"
                                                      }
                                                    },
                                                    "children": [
                                                      {
                                                        "success": true,
                                                        "node": {
                                                          "type": "feature",
                                                          "feature": {
                                                            "type": "api",
                                                            "api": "wininet.InternetCloseHandle"
                                                          }
                                                        },
                                                        "children": [],
                                                        "locations": [
                                                          {
                                                            "type": "absolute",
                                                            "value": 4200562
                                                          },
                                                          {
                                                            "type": "absolute",
                                                            "value": 4200565
                                                          }
                                                        ],
                                                        "captures": {}
                                                      }
                                                    ],
                                                    "locations": [],
                                                    "captures": {}
                                                  },
                                                  {
                                                    "success": true,
                                                    "node": {
                                                      "type": "statement",
                                                      "statement": {
                                                        "type": "or"
                                                      }
                                                    },
                                                    "children": [
                                                      {
                                                        "success": true,
                                                        "node": {
                                                          "type": "feature",
                                                          "feature": {
                                                            "type": "api",
                                                            "api": "wininet.InternetOpen"
                                                          }
                                                        },
                                                        "children": [],
                                                        "locations": [
                                                          {
                                                            "type": "absolute",
                                                            "value": 4200464
                                                          }
                                                        ],
                                                        "captures": {}
                                                      },
                                                      {
                                                        "success": false,
                                                        "node": {
                                                          "type": "feature",
                                                          "feature": {
                                                            "type": "api",
                                                            "api": "System.Net.WebRequest::Create"
                                                          }
                                                        },
                                                        "children": [],
                                                        "locations": [],
                                                        "captures": {}
                                                      },
                                                      {
                                                        "success": false,
                                                        "node": {
                                                          "type": "feature",
                                                          "feature": {
                                                            "type": "api",
                                                            "api": "System.Net.WebRequest::CreateDefault"
                                                          }
                                                        },
                                                        "children": [],
                                                        "locations": [],
                                                        "captures": {}
                                                      },
                                                      {
                                                        "success": false,
                                                        "node": {
                                                          "type": "feature",
                                                          "feature": {
                                                            "type": "api",
                                                            "api": "System.Net.WebRequest::CreateHttp"
                                                          }
                                                        },
                                                        "children": [],
                                                        "locations": [],
                                                        "captures": {}
                                                      }
                                                    ],
                                                    "locations": [],
                                                    "captures": {}
                                                  }
                                                ],
                                                "locations": [],
                                                "captures": {}
                                              }
                                            ],
                                            "locations": [
                                              {
                                                "type": "absolute",
                                                "value": 4200448
                                              }
                                            ],
                                            "captures": {}
                                          }
                                        ],
                                        "locations": [],
                                        "captures": {}
                                      }
                                    ],
                                    "locations": [],
                                    "captures": {}
                                  }
                                ],
                                "locations": [
                                  {
                                    "type": "absolute",
                                    "value": 4200448
                                  }
                                ],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": true,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "or"
                          }
                        },
                        "children": [
                          {
                            "success": true,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "wininet.InternetReadFile"
                              }
                            },
                            "children": [],
                            "locations": [
                              {
                                "type": "absolute",
                                "value": 4200549
                              }
                            ],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "wininet.InternetReadFileEx"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "System.Net.WebClient::DownloadString"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "System.Net.WebClient::DownloadStringAsync"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "System.Net.WebClient::DownloadStringTaskAsync"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "System.Net.WebClient::DownloadData"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "System.Net.WebClient::DownloadDataAsync"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "System.Net.WebClient::DownloadDataTaskAsync"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4200448
                  }
                ],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "match",
                    "match": "download URL"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "query environment variable": {
      "meta": {
        "name": "query environment variable",
        "namespace": "host-interaction/environment-variable",
        "authors": [
          "michael.hunhoff@mandiant.com",
          "@_re_fox"
        ],
        "scope": "function",
        "attack": [
          {
            "parts": [
              "Discovery",
              "System Information Discovery"
            ],
            "tactic": "Discovery",
            "technique": "System Information Discovery",
            "subtechnique": "",
            "id": "T1082"
          }
        ],
        "mbc": [
          {
            "parts": [
              "Discovery",
              "System Information Discovery"
            ],
            "objective": "Discovery",
            "behavior": "System Information Discovery",
            "method": "",
            "id": "E1082"
          }
        ],
        "references": [],
        "examples": [
          "Practical Malware Analysis Lab 14-02.exe_:0x401880",
          "0761142efbda6c4b1e801223de723578:0x65483490"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: query environment variable\r\n    namespace: host-interaction/environment-variable\r\n    authors:\r\n      - michael.hunhoff@mandiant.com\r\n      - \"@_re_fox\"\r\n    scope: function\r\n    att&ck:\r\n      - Discovery::System Information Discovery [T1082]\r\n    mbc:\r\n      - Discovery::System Information Discovery [E1082]\r\n    examples:\r\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\r\n      - 0761142efbda6c4b1e801223de723578:0x65483490\r\n  features:\r\n    - or:\r\n      - api: kernel32.GetEnvironmentVariable\r\n      - api: kernel32.GetEnvironmentStrings\r\n      - api: kernel32.ExpandEnvironmentStrings\r\n      - api: msvcr90.getenv\r\n      - api: msvcrt.getenv\r\n      - api: System.Environment::GetEnvironmentVariable\r\n      - api: System.Environment::GetEnvironmentVariables\r\n      - api: System.Environment::ExpandEnvironmentVariables\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4200576
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "or"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.GetEnvironmentVariable"
                  }
                },
                "children": [],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4200660
                  }
                ],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.GetEnvironmentStrings"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "kernel32.ExpandEnvironmentStrings"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "msvcr90.getenv"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "msvcrt.getenv"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Environment::GetEnvironmentVariable"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Environment::GetEnvironmentVariables"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              },
              {
                "success": false,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "api",
                    "api": "System.Environment::ExpandEnvironmentVariables"
                  }
                },
                "children": [],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "get COMSPEC environment variable": {
      "meta": {
        "name": "get COMSPEC environment variable",
        "namespace": "host-interaction/environment-variable",
        "authors": [
          "matthew.williams@mandiant.com"
        ],
        "scope": "function",
        "attack": [
          {
            "parts": [
              "Discovery",
              "System Information Discovery"
            ],
            "tactic": "Discovery",
            "technique": "System Information Discovery",
            "subtechnique": "",
            "id": "T1082"
          }
        ],
        "mbc": [
          {
            "parts": [
              "Operating System",
              "Environment Variable"
            ],
            "objective": "Operating System",
            "behavior": "Environment Variable",
            "method": "",
            "id": "C0034"
          }
        ],
        "references": [],
        "examples": [
          "Practical Malware Analysis Lab 14-02.exe_:0x401880"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: get COMSPEC environment variable\r\n    namespace: host-interaction/environment-variable\r\n    authors:\r\n      - matthew.williams@mandiant.com\r\n    scope: function\r\n    att&ck:\r\n      - Discovery::System Information Discovery [T1082]\r\n    mbc:\r\n      - Operating System::Environment Variable [C0034]\r\n    examples:\r\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\r\n  features:\r\n    - and:\r\n      - match: query environment variable\r\n      - or:\r\n        - string: \"COMSPEC\"\r\n        - string: \"%COMSPEC%\"\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4200576
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "feature",
                  "feature": {
                    "type": "match",
                    "match": "query environment variable"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "statement",
                      "statement": {
                        "type": "or"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.GetEnvironmentVariable"
                          }
                        },
                        "children": [],
                        "locations": [
                          {
                            "type": "absolute",
                            "value": 4200660
                          }
                        ],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.GetEnvironmentStrings"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "kernel32.ExpandEnvironmentStrings"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "msvcr90.getenv"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "msvcrt.getenv"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "System.Environment::GetEnvironmentVariable"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "System.Environment::GetEnvironmentVariables"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      },
                      {
                        "success": false,
                        "node": {
                          "type": "feature",
                          "feature": {
                            "type": "api",
                            "api": "System.Environment::ExpandEnvironmentVariables"
                          }
                        },
                        "children": [],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [
                  {
                    "type": "absolute",
                    "value": 4200576
                  }
                ],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "string",
                        "string": "COMSPEC"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4200655
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "string",
                        "string": "%COMSPEC%"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    },
    "self delete": {
      "meta": {
        "name": "self delete",
        "namespace": "anti-analysis/anti-forensic/self-deletion",
        "authors": [
          "michael.hunhoff@mandiant.com",
          "@mr-tz"
        ],
        "scope": "function",
        "attack": [
          {
            "parts": [
              "Defense Evasion",
              "Indicator Removal",
              "File Deletion"
            ],
            "tactic": "Defense Evasion",
            "technique": "Indicator Removal",
            "subtechnique": "File Deletion",
            "id": "T1070.004"
          }
        ],
        "mbc": [
          {
            "parts": [
              "Defense Evasion",
              "Self Deletion",
              "COMSPEC Environment Variable"
            ],
            "objective": "Defense Evasion",
            "behavior": "Self Deletion",
            "method": "COMSPEC Environment Variable",
            "id": "F0007.001"
          }
        ],
        "references": [],
        "examples": [
          "Practical Malware Analysis Lab 14-02.exe_:0x401880"
        ],
        "description": "",
        "lib": false,
        "is_subscope_rule": false,
        "maec": {}
      },
      "source": "rule:\r\n  meta:\r\n    name: self delete\r\n    namespace: anti-analysis/anti-forensic/self-deletion\r\n    authors:\r\n      - michael.hunhoff@mandiant.com\r\n      - \"@mr-tz\"\r\n    scope: function\r\n    att&ck:\r\n      - Defense Evasion::Indicator Removal::File Deletion [T1070.004]\r\n    mbc:\r\n      - Defense Evasion::Self Deletion::COMSPEC Environment Variable [F0007.001]\r\n    examples:\r\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\r\n  features:\r\n    - and:\r\n      - or:\r\n        - match: get COMSPEC environment variable\r\n        - string: \"cmd.exe\"\r\n        - match: host-interaction/process/create\r\n      - or:\r\n        - string: /\\/c\\s*del\\s*/\r\n          description: \"/c del\"\r\n        - string: /del\\s*\\S/\r\n          description: \"del \\\"%s\\\"\"\r\n      - optional:\r\n        - string: /\\s*>\\s*nul\\s*/i\r\n          description: \"> nul\"\r\n",
      "matches": [
        [
          {
            "type": "absolute",
            "value": 4200576
          },
          {
            "success": true,
            "node": {
              "type": "statement",
              "statement": {
                "type": "and"
              }
            },
            "children": [
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "optional"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "regex",
                        "regex": "/\\s*>\\s*nul\\s*/i",
                        "description": "> nul"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4200721
                      }
                    ],
                    "captures": {
                      " > nul": [
                        {
                          "type": "absolute",
                          "value": 4200721
                        }
                      ]
                    }
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "match",
                        "match": "get COMSPEC environment variable"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "and"
                          }
                        },
                        "children": [
                          {
                            "success": true,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "match",
                                "match": "query environment variable"
                              }
                            },
                            "children": [
                              {
                                "success": true,
                                "node": {
                                  "type": "statement",
                                  "statement": {
                                    "type": "or"
                                  }
                                },
                                "children": [
                                  {
                                    "success": true,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "kernel32.GetEnvironmentVariable"
                                      }
                                    },
                                    "children": [],
                                    "locations": [
                                      {
                                        "type": "absolute",
                                        "value": 4200660
                                      }
                                    ],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "kernel32.GetEnvironmentStrings"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "kernel32.ExpandEnvironmentStrings"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "msvcr90.getenv"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "msvcrt.getenv"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "System.Environment::GetEnvironmentVariable"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "System.Environment::GetEnvironmentVariables"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  },
                                  {
                                    "success": false,
                                    "node": {
                                      "type": "feature",
                                      "feature": {
                                        "type": "api",
                                        "api": "System.Environment::ExpandEnvironmentVariables"
                                      }
                                    },
                                    "children": [],
                                    "locations": [],
                                    "captures": {}
                                  }
                                ],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [
                              {
                                "type": "absolute",
                                "value": 4200576
                              }
                            ],
                            "captures": {}
                          },
                          {
                            "success": true,
                            "node": {
                              "type": "statement",
                              "statement": {
                                "type": "or"
                              }
                            },
                            "children": [
                              {
                                "success": true,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "string",
                                    "string": "COMSPEC"
                                  }
                                },
                                "children": [],
                                "locations": [
                                  {
                                    "type": "absolute",
                                    "value": 4200655
                                  }
                                ],
                                "captures": {}
                              },
                              {
                                "success": false,
                                "node": {
                                  "type": "feature",
                                  "feature": {
                                    "type": "string",
                                    "string": "%COMSPEC%"
                                  }
                                },
                                "children": [],
                                "locations": [],
                                "captures": {}
                              }
                            ],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4200576
                      }
                    ],
                    "captures": {}
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "string",
                        "string": "cmd.exe"
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  },
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "match",
                        "match": "host-interaction/process/create"
                      }
                    },
                    "children": [
                      {
                        "success": true,
                        "node": {
                          "type": "statement",
                          "statement": {
                            "type": "or"
                          }
                        },
                        "children": [
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "kernel32.WinExec"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "kernel32.CreateProcess"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "shell32.ShellExecute"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": true,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "shell32.ShellExecuteEx"
                              }
                            },
                            "children": [],
                            "locations": [
                              {
                                "type": "absolute",
                                "value": 4200833
                              }
                            ],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "advapi32.CreateProcessAsUser"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "advapi32.CreateProcessWithLogon"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "advapi32.CreateProcessWithToken"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "kernel32.CreateProcessInternal"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "ntdll.NtCreateUserProcess"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "ntdll.NtCreateProcess"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "ntdll.NtCreateProcessEx"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "ntdll.ZwCreateProcess"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "ZwCreateProcessEx"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "ntdll.ZwCreateUserProcess"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "ntdll.RtlCreateUserProcess"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          },
                          {
                            "success": false,
                            "node": {
                              "type": "feature",
                              "feature": {
                                "type": "api",
                                "api": "System.Diagnostics.Process::Start"
                              }
                            },
                            "children": [],
                            "locations": [],
                            "captures": {}
                          }
                        ],
                        "locations": [],
                        "captures": {}
                      }
                    ],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4200674
                      }
                    ],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              },
              {
                "success": true,
                "node": {
                  "type": "statement",
                  "statement": {
                    "type": "or"
                  }
                },
                "children": [
                  {
                    "success": true,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "regex",
                        "regex": "/\\/c\\s*del\\s*/",
                        "description": "/c del"
                      }
                    },
                    "children": [],
                    "locations": [
                      {
                        "type": "absolute",
                        "value": 4200681
                      }
                    ],
                    "captures": {
                      "/c del ": [
                        {
                          "type": "absolute",
                          "value": 4200681
                        }
                      ]
                    }
                  },
                  {
                    "success": false,
                    "node": {
                      "type": "feature",
                      "feature": {
                        "type": "regex",
                        "regex": "/del\\s*\\S/",
                        "description": "del \"%s\""
                      }
                    },
                    "children": [],
                    "locations": [],
                    "captures": {}
                  }
                ],
                "locations": [],
                "captures": {}
              }
            ],
            "locations": [],
            "captures": {}
          }
        ]
      ]
    }
  }
}
